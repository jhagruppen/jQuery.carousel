/*
**  Copyright 2012, Andreas Johansson
**  Licensed under a MIT license, http://ibuypink.com/mit-license/
**
*/(function(b){b.fn.carouselFade=function(c){function n(){f=!0;o({rel:"next"})}function o(a){switch(a.rel){case"next":g="add";break;case"prev":g="subtract";break;default:g="episode"}var b=i[q(a.href)];if(m){b.removeClass(c.fadeOut).addClass(c.fadeIn).siblings().removeClass(c.fadeIn).addClass(c.fadeOut);f=!1}else b.fadeTo(c.transtime,1,function(){f=!1}).siblings().fadeTo(c.transtime,0);p(a)}function p(a){l.find("a").removeClass(c.active);var b=l.find(".item-"+(e+1)+" a");b.length>0&&b.addClass(c.active)}function q(a){g==="episode"&&(e=b(a).index());if(e===i.length-1){g==="add"&&(e=0);g==="subtract"&&e--}else if(e===0){g==="add"&&e++;g==="subtract"&&(e=i.length-1)}else{g==="add"&&e++;g==="subtract"&&e--}return e}function r(d){if(b(c.control).length===0)switch(d){case"carousel":j.after('<ul id="'+c.control.replace("#","")+'"></ul>');l=b(c.control);l.append('<li><a href="#item" rel="prev">Prev</a></li>');l.append('<li><a href="#item" rel="next">Next</a></li>');break;case"all":j.children().each(function(d){if(d===0){j.after('<ul id="'+c.control.replace("#","")+'"></ul>');l=b(c.control);l.append('<li><a href="" rel="prev">Prev</a></li>')}a=d+1;l.append('<li class="item-'+a+'"><a href="#item-'+a+'" rel="episode">'+a+"</a></li>");d===j.children().length-1&&l.append('<li><a href="" rel="next">Next</a></li>')});break;default:j.children().each(function(d){if(d===0){j.after('<ul id="'+c.control.replace("#","")+'"></ul>');l=b(c.control)}a=d+1;l.append('<li class="item-'+a+'"><a href="#item-'+a+'" rel="episode">'+a+"</a></li>")})}return b(c.control)}var d={nav:"all",control:"#billboard-nav",transtime:1e3,fadeOut:"fade-out",fadeIn:"fade-in",active:"active",delay:500},c=b.extend(d,c),e=0,f=!1,g="add",h,i=new Array,j=b(this),k=j.width(),l=r(c.nav),m=Modernizr.csstransitions;return this.each(function(){j.find(".item").each(function(a){var d=b(this).addClass("item-"+(a+1)).attr({style:"transition-duration:"+c.transtime+"ms"+"; -moz-transition-duration:"+c.transtime+"ms"+"; -webkit-transition-duration:"+c.transtime+"ms"+"; -o-transition-duration:"+c.transtime+"ms"});i[a]=d});b(c.control).find("a").on("click",function(){var a=b(this);f||o({rel:a.attr("rel"),href:a.attr("href")});clearInterval(h);return!1});j.find(":first-child").addClass("fade-in");p();h=setInterval(n,c.transtime+c.delay)})}})(jQuery);